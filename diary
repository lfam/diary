#!/bin/sh

do_git() {
	git rev-parse --git-dir 2> /dev/null &&
	git add $1 &&
	printf "Auto-commit by diary of $1\n" | git commit $1 -F - 
}

prepend_date() {
	date="$(date -R)"
	printf "$date\n\n" | cat - $1 > $1.swp && mv $1.swp $1
}

main() {

	diary=.log
	touch $diary
	prepend_date $diary
	${EDITOR:-vi} $diary
	do_git $diary
}

main
